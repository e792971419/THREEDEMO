<!--
 * @Author: your name
 * @LastEditors: xiasong
 * @Date: 2021-01-13 18:03:37
 * @LastEditTime: 2021-01-15 16:45:14
 * @Description: description
 * @FilePath: \THREEDEMO\src\special_zone\index.html
-->

<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <!-- <title>demo</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/react/16.14.0/umd/react.development.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/react-dom/16.14.0/umd/react-dom.development.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/babel-standalone/6.15.0/babel.min.js"></script> -->
    <!-- <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script> -->
    <script src="./axios.min.js"></script>
    <script src="./react.development.min.js"></script>
    <script src="./react-dom.development.min.js"></script>
    <script src="./babel.min.js"></script>
    <style>
      html,
      body,
      div,
      p,
      a,
      span,
      ul,
      ol,
      li,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        margin: 0;
        padding: 0;
      }

      ul,
      ol,
      li {
        list-style: none;
      }
    </style>
  </head>
  <body>
    <div id="app"></div>
    <script type="text/babel">
      const { useEffect, useState, useContext, createContext } = React;

      // 单个 渲染模板
      const UnitEle = (props) => {
        const { isPc, unitData } = props;
        if (!unitData) return null;
        const { title, subTitle, des, unitList } = unitData;
        // console.log(unitList);
        const eleHeight = {
          des: 70, // 第一层描述
          title: 63, // 第二层 title
          des_sec: 190, // 第二次 des
          title_three: 53, // 第三层title
          des_three: 66, // 第四层描述
        };

        const changeHeight = () => {
          let curHeight = 0;
          if (des) curHeight += 70;
          if (unitList && Array.isArray(unitList)) {
            unitList.forEach((item) => {
              if (item.title) curHeight += 63;
              if (item.des) curHeight += 190;
              if (item.unitAtom && Array.isArray(item.unitAtom)) {
                item.unitAtom.forEach((cItem) => {
                  if (cItem.title) curHeight += 53;
                  if (cItem.moreInfo && Array.isArray(cItem.moreInfo)) {
                    cItem.moreInfo.forEach((caItem) => {
                      if (caItem) curHeight += 66;
                    });
                  }
                });
              }
            });
          }
          return curHeight;
        };
        console.log(changeHeight());
        let countHeight = changeHeight();

        // 选择 展示 三段模块 以及中间超过的时候 具体划分
        const selectPart = (type) => {
          const first = () => {
            return (
              <div
                style={{ width: "100%", position: "absolute", top: 0, left: 4 }}
              >
                <img
                  src="../image/special_zone/bd_first.png"
                  style={{ width: "100%" }}
                />
              </div>
            );
          };

          const second = () => {
            const secDemo = (per) => {
              console.log(per);
              return (
                <div
                  style={{
                    width: "100%",
                    position: "absolute",
                    top: per ? per : "50%",
                    left: 4,
                  }}
                >
                  <img
                    src="../image/special_zone/bd_second.png"
                    style={{ width: "100%" }}
                  />
                </div>
              );
            };

            let initalPer = [20];

            if (countHeight > 1200 || countHeight < 1700) {
              initalPer.push(40);
            }

            return initalPer.map((item) => secDemo(`${item}%`));
          };

          const three = () => {
            return (
              <div
                style={{
                  width: "100%",
                  position: "absolute",
                  bottom: 0,
                  left: 4,
                }}
              >
                <img
                  src="../image/special_zone/bd_three.png"
                  style={{ width: "100%" }}
                />
              </div>
            );
          };

          if (!type) return null;
          if (type === "first") {
            return first();
          } else if (type === "three") {
            if (countHeight > 700) {
              return three();
            }
          } else if (type === "second") {
            return second();
          }
        };

        return (
          <div style={{ width: "100%" }}>
            <div style={{ position: "relative" }}>
              <img
                src="../image/special_zone/bd_title2.jpg"
                style={{ display: "block", width: "100%" }}
              />
              <div
                style={{
                  position: "absolute",
                  top: "50%",
                  left: "50%",
                  transform: "translateX(-50%) translateY(-50%)",
                  color: "#fff",
                }}
              >
                <p
                  style={{
                    fontSize: isPc ? 50 : 40,
                    textAlign: "center",
                    marginTop: isPc ? 0 : "-6px",
                  }}
                >
                  {title ? title : ""}
                </p>
                <p
                  style={{
                    fontSize: isPc ? 30 : 25,
                    textAlign: "center",
                    marginTop: isPc ? 10 : 0,
                  }}
                >
                  {subTitle ? subTitle : ""}
                </p>
              </div>
            </div>

            <div>
              <img
                src="../image/special_zone/bd_top2.jpg"
                style={{ display: "block", width: "100%" }}
              />
            </div>

            <div
              style={{
                position: "relative",
                backgroundImage: `url(${"../image/special_zone/10_2.jpg"})`,
                backgroundPosition: "center",
                backgroundRepeat: "repeat",
                backgroundSize: "contain",
                width: "100%",
                height: "fit-content",
                marginLeft: isPc ? "-3px" : "-2px",
              }}
            >
              {selectPart("first")}
              {selectPart("second")}
              {selectPart("three")}
              <div
                style={{
                  width: "60%",
                  margin: "0 auto",
                  marginTop: "-5%",
                }}
              >
                {des ? (
                  <p
                    style={{
                      color: "#996666",
                      fontSize: 30,
                      paddingBottom: 30,
                    }}
                  >
                    {des}
                  </p>
                ) : (
                  ""
                )}
                <div>
                  <ul>
                    {Array.from(
                      unitList && Array.isArray(unitList) ? unitList : [],
                      (item, index) => {
                        return (
                          <li key={index}>
                            {item.title && (
                              <p style={{ display: "flex", paddingTop: 60 }}>
                                <span
                                  style={{
                                    display: "block",
                                    padding: "5px 15px",
                                    backgroundColor: "#C52518",
                                    color: "#fff",
                                    borderRadius: 5,
                                    fontSize: 40,
                                  }}
                                >
                                  {item.title}
                                </span>
                              </p>
                            )}
                            {item.des && (
                              <p
                                style={{
                                  color: "#996666",
                                  fontSize: 30,
                                  padding: "40px 0 30px",
                                }}
                              >
                                {item.des}
                              </p>
                            )}

                            <ul>
                              {Array.from(
                                item.unitAtom && Array.isArray(item.unitAtom)
                                  ? item.unitAtom
                                  : [],
                                (cItem, cIndex) => {
                                  return (
                                    <li key={cIndex}>
                                      {cItem.title && (
                                        <p
                                          style={{
                                            color: "#3782C2",
                                            fontSize: 40,
                                          }}
                                        >
                                          {cItem.title}:
                                        </p>
                                      )}

                                      <ul
                                        style={{
                                          fontSize: 35,
                                          color: "#6A0300",
                                        }}
                                      >
                                        {Array.from(
                                          cItem.moreInfo &&
                                            Array.isArray(cItem.moreInfo)
                                            ? cItem.moreInfo
                                            : [],
                                          (acItem, acIndex) => {
                                            return acItem ? (
                                              <li
                                                style={{ paddingTop: 20 }}
                                                key={acIndex}
                                              >
                                                {acItem}
                                              </li>
                                            ) : null;
                                          }
                                        )}
                                      </ul>
                                    </li>
                                  );
                                }
                              )}
                            </ul>
                          </li>
                        );
                      }
                    )}
                  </ul>
                </div>
              </div>
            </div>

            <div style={{ marginTop: "-2px", marginLeft: "-2px" }}>
              <img
                src="../image/special_zone/bd_bottom4.jpg"
                style={{ width: "100%", display: "block" }}
              />
            </div>
          </div>
        );
      };

      const Demo = () => {
        const [isPc, setIsPc] = useState(true);
        const [backData, setBackData] = useState({});

        useEffect(() => {
          onWindowResize();
          fetchCurrentData();
          window.addEventListener("resize", onWindowResize);
        }, []);

        // 请求 当前页的数据
        const fetchCurrentData = () => {
          axios
            .get("./data.json")
            .then((res) => {
              // console.log(res.data);
              setBackData(res.data);
            })
            .catch((error) => {
              console.log(error);
            });
        };

        // 监听 窗口变化
        const onWindowResize = () => {
          let Width =
            window.innerWidth ||
            document.documentElement.clientWidth ||
            document.body.clientWidth;
          if (Width > 1400) {
            setIsPc(true);
          } else {
            setIsPc(false);
          }
        };

        const { des, date, productList } = backData;
        return (
          <div
            style={{
              backgroundColor: "#7D171D",
              width: "100%",
              height: "100%",
            }}
          >
            <div style={{ width: "100%" }}>
              <img
                src="../image/special_zone/bg_top.jpg"
                style={{ width: "100%", display: "block" }}
              />
            </div>
            <div
              style={{
                width: "100%",
                height: "auto",
                padding: "0 158px",
                boxSizing: "border-box",
                display: "flex",
                flexDirection: "column",
                justifyContent: "center",
                alignItems: "center",
              }}
            >
              <div
                style={{
                  color: "#FFB100",
                  display: "flex",
                  flexDirection: "column",
                  justifyContent: "center",
                  alignItems: "center",
                }}
              >
                {des && (
                  <div
                    style={{
                      fontSize: 35,
                      textIndent: "3rem",
                      textAlign: "justify",
                    }}
                  >
                    {des}
                  </div>
                )}
                {date && (
                  <div style={{ fontSize: 30, paddingTop: 60 }}>
                    <span>活动时间：</span> {date}
                  </div>
                )}
              </div>
              {Array.from(
                productList && Array.isArray(productList) ? productList : [],
                (item, index) => {
                  return <UnitEle isPc={isPc} unitData={item} key={index} />;
                }
              )}
            </div>
            <div
              style={{
                width: "100%",
                height: "fit-content",
                display: "flex",
                justifyContent: "center",
                alignItems: "center",
                flexDirection: "column",
                padding: "100px 0",
              }}
            >
              <img src="../image/special_zone/code.jpg" />
              <div
                style={{
                  color: "#c79b9e",
                  textAlign: "center",
                  fontSize: isPc ? "inherit" : 30,
                }}
              >
                <p style={{ margin: "10px auto" }}>
                  如有所需,扫码后联通经理与您联系!
                </p>
                <p>更多产品详询当地联通</p>
              </div>
            </div>
          </div>
        );
      };

      ReactDOM.render(<Demo />, document.getElementById("app"));
    </script>
  </body>
</html>
